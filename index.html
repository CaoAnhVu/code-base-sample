<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="./src/assets/images/flags/vi-flag.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>Code Base Sample</title>
    <style>
      /* Fallback styles if JavaScript fails */
      #root:empty {
        display: none;
      }

      #loading-fallback {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100vh;
        width: 100%;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        flex-direction: column;
      }

      #loading-fallback .spinner {
        width: 48px;
        height: 48px;
        border: 4px solid #e5e7eb;
        border-radius: 50%;
        border-top-color: #4f46e5;
        animation: spin 1s ease-in-out infinite;
        margin-bottom: 16px;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      #javascript-disabled {
        display: none;
      }

      .noscript #javascript-disabled {
        display: block;
        padding: 20px;
        text-align: center;
        color: #991b1b;
        background-color: #fee2e2;
        border-radius: 4px;
        margin: 20px;
      }
    </style>
  </head>
  <body>
    <!-- Add fallback when JavaScript is disabled -->
    <noscript>
      <div id="javascript-disabled">
        <h1>JavaScript is required</h1>
        <p>Please enable JavaScript to use this application.</p>
      </div>
    </noscript>

    <!-- Main app container -->
    <div id="root"></div>

    <!-- Loading fallback that will show until React renders -->
    <div id="loading-fallback">
      <div class="spinner"></div>
      <p>Loading application...</p>
    </div>

    <script>
      // Hide loading fallback when React renders the app
      window.addEventListener('DOMContentLoaded', function () {
        var rootEl = document.getElementById('root');
        var loadingEl = document.getElementById('loading-fallback');
        var observer = new MutationObserver(function (mutations) {
          if (rootEl.childNodes.length > 0) {
            loadingEl.style.display = 'none';
          }
        });
        observer.observe(rootEl, { childList: true });

        // Fallback if nothing renders after 5 seconds
        setTimeout(function () {
          if (rootEl.childNodes.length === 0) {
            loadingEl.innerHTML = `
              <h1 style="color: #991b1b; margin-bottom: 16px;">Something went wrong</h1>
              <p style="margin-bottom: 16px;">The application failed to load properly.</p>
              <button onclick="window.location.reload()" 
                style="padding: 8px 16px; background: #4f46e5; color: white; 
                border: none; border-radius: 4px; cursor: pointer;">
                Try Again
              </button>
            `;
          }
        }, 5000);
      });
    </script>

    <!-- Reset app script -->
    <script>
      // Add keyboard shortcut for app reset (Ctrl+Shift+R)
      document.addEventListener('keydown', function (e) {
        if (e.ctrlKey && e.shiftKey && e.key === 'R') {
          e.preventDefault();
          var script = document.createElement('script');
          script.src = '/reset.js?' + new Date().getTime();
          document.body.appendChild(script);
        }
      });
    </script>

    <!-- Debug script -->
    <script src="/public/debug.js"></script>

    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
